#!/usr/bin/env python
# -*- coding: utf-8 -*-

from datetime import timedelta

from beyond.propagators.analytical import Sgp4Beta
from beyond.io.tle import Tle


def test_one(helper):

    test_cases = {
        """1 25544U 98067A   08264.51782528 -.00002182  00000-0 -11606-4 0  2927
2 25544  51.6416 247.4627 0006703 130.5360 325.0288 15.72125391563537""":
            ([-3199119.3019953547, -5925838.8951945184, -104283.88301037039, 4160.9001260610321, -2340.8666910921365, 6034.2397874890266]),
        """1 27421U 02021A   15290.39156189  .00000174  00000-0  10000-3 0  9996
2 27421  98.4973 341.4832 0001168 101.4896  26.7296 14.20902451697482""":
            ([-6313390.5470795343, 2392162.4266701187, -2518309.642217699, 2810.1811696038776, 188.82949370476567, -6882.790571054541]),
        """1 38012U 11076F   15290.43560975 -.00001375  00000-0 -28626-3 0  9990
2 38012  98.1856   3.4028 0001255  65.6426 294.5016 14.58534477204126""":
            ([-6278750.6667313213, -8651.4824499131028, -3277187.0595075251, 3419.2465632815151, 1208.7786614934848, -6564.4998427326509]),
        """1 25544U 98067A   15290.14517523  .00013306  00000-0  20592-3 0  9999
2 25544  51.6447 195.3542 0006630  48.0978  95.2885 15.54379613967013""":
            ([-6596477.2658053627, 63108.245806605715, -1577202.6429111576, -1410.6459948627141, -4877.7460063862927, 5746.8315844151275]),
    }

    for lines, expected in test_cases.items():
        tle = Tle(lines).orbit()

        sgp4 = Sgp4Beta()
        sgp4.orbit = tle
        pv = sgp4.propagate(tle.date + timedelta(days=1))
        
        helper.assert_vector(pv, expected)
